---
title: "Homework 5"
author: "Juan Cambeiro"
date: "2022-11-16"
output: github_document
---


```{r setup, include=FALSE}
library(tidyverse)
library(rvest)
library(readxl)
library(ggridges)
library(patchwork)
library(readr)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```


## Problem 2

First, I will import and clean the homicide data that was gathered by The Washington Post and describe the raw data.
```{r}
homicide =
  read_csv("data/homicide-data.csv") %>%
  janitor::clean_names()
```

**Description of raw data**: This homicides dataset collected by The Washington Post includes data on `r nrow(homicide)` in 50 of the largest American cities. The dataset contains `r ncol(homicide)` variables, including: the report date of the murder (`report_date`), the victim's first and last name (`victim_first`, `victim_last`), key demographics of the victim (`victim_race`, `victim_age`, `victim_sex`), the location (`city`, `state`, `lat`, `lon`), and the status of the case (`disposition`). 


Next, I will tidy the data by using `mutate` to ensure appropriate data types and to make a `city_state` variable. 
```{r}
homicidetidy = homicide %>%
  mutate(city_state = as.factor(str_c(city, state, sep = ", ")), 
         reported_date = as.Date(as.character(reported_date),"%Y%m%d"), 
         victim_age = as.numeric(victim_age), 
         victim_sex = as.factor(victim_sex),
         victim_race = as.factor(victim_race), 
         city = as.factor(city),
         state = as.factor(state)) 
```


Now, I will use `group by` and `summarize` to  obtain the total number of homicides and number of unsolved homicides by city and display these totals by city.
```{r}
summary_by_city = homicidetidy %>% 
  group_by(city_state) %>% 
  summarize(homicides_n = n(), 
            unsolved_n = sum(disposition == c("Closed without arrest", "Open/No arrest")))
knitr::kable(summary_by_city)
```


Next, I run `prop.test` for each of the cities in my dataset `summary_by_city` to estimate the proportion of homicides that are unsolved in Baltimore, MD. 
```{r}
baltimore =
  summary_by_city %>%
  filter(city_state == "Baltimore, MD") 
baltimore_test = prop.test(
  x = baltimore[["unsolved_n"]],
  n = baltimore[["homicides_n"]]) %>%
  broom::tidy() %>%
  select(estimate, conf.low, conf.high)
knitr::kable(baltimore_test)
```
I find an estimate of 0.32 (95% CI: 0.30, 0.34) for the proportion of of homicides that are unsolved in Baltimore, MD.


Now, 


